+++
title= "hammerspoon config for mac"
description= "macOS 自动化工具"
date = "2025-10-15"
tags = [
    "hammerspoon"
]
categories = [
  "技术"
]
series = [
  "工具"
]
#menu = "main"
+++

#### 说明
   Hammerspoon 是一款革命性的 macOS 桌面自动化工具，它将系统级 API 与灵活的 Lua 脚本引擎相结合。通过编写自定义的 Lua 脚本，您可以对系统进行强大的控制。   
   程序员一般的工作习惯都是两个显示屏幕，两个浏览器窗口，多个编程编辑器窗口，再加至少一个即时通讯工具,或者还有一个终端console。如果使用系统快捷键切换不够精确，用鼠标又不方便，特别是需要把光标移到扩展的显示屏的时候。Hammerspoon作为一个专业的macos自动化工具可以带领很大的方便。
   + 如果快捷键不起作用，切换输入法为英文.
   + 以下快捷键，里面有“+”号，表示分段，不代表键盘，先按前面部分，在1秒内再按后面部分。
   + vscode版本:1.80.1. 安装了golang,vim插件。macos 12.6.
   + https://github.com/Hammerspoon/hammerspoon

##### 环境

   + Macos 14 
   + Hammerspoon 1.0.0

##### 安装
   + 官方连接 https://github.com/Hammerspoon/hammerspoon
   + 参考说明，下载dmg文件安装或者brew安装均可。


##### 默认功能快捷键
   + ⌘+`, `为tab键上面的按键。弹出来一个选择窗口,如下:
    ![image](images/post/tools/2015-10-15-1.jpg)
   + 再按数字或者字母，即可切换到对应的窗口。

##### 自定义功能快捷键

   + 点击右上角🔨图标，选择 “open config",可以自己写lua脚本。再次选择 “reload config”即可生效。  
   + lua脚本功能可参考github官网.  
   + 以下是我个人实现的一些功能，比如鼠标光标在主显示屏和扩展屏之间切换, vscode多个窗口循环切换等。  

   ```
local hotswitchHs = require("hotswitch-hs/hotswitch-hs")
-- hotswitchHs.enableAutoUpdate() -- If you don't want to update automatically, remove this line.
--hotswitchHs.setAutoGeneratedKeys({"1", "2", "3", "4", "5", "6", "7", "8", "9", "0"})
hotswitchHs.enableAllSpaceWindows()

hs.hotkey.bind({"command"}, "`", hotswitchHs.openOrClose) -- Set a keybind you like to open HotSwitch-HS panel.

-- 使用【Option+tab】在不同屏幕之间移动鼠标
-- option==alt
hs.hotkey.bind({'option'}, 'tab', function()
    local screen = hs.mouse.getCurrentScreen()
    local nextScreen = screen:next()
    local rect = nextScreen:fullFrame()
    local center = hs.geometry.rectMidPoint(rect)
    hs.mouse.absolutePosition(center)
end)
  
-- 使用【Option+W】在不同屏幕之间移动窗口
hs.hotkey.bind({'option'}, 'W', function()
    -- get the focused window
    local win = hs.window.focusedWindow()
    -- get the screen where the focused window is displayed, a.k.a. current screen
    local screen = win:screen()
    -- compute the unitRect of the focused window relative to the current screen
    -- and move the window to the next screen setting the same unitRect 
    win:move(win:frame():toUnitRect(screen:frame()), screen:next(), true, 0)
end)

local function openApp(appName)
    local app = hs.application.get(appName)
    if not app then
        hs.application.launchOrFocus(appName)
    else
        app:activate()
         -- 移动鼠标到窗口中心
        local f = target:frame()
        hs.mouse.setAbsolutePosition({ x = f.x + f.w / 2, y = f.y + f.h / 2 })
    end
end

-- alt+ a - z
hs.hotkey.bind({'alt'}, 'c', function() openApp("Chrome") end)
hs.hotkey.bind({'alt'}, 'i', function() openApp("微信") end)
hs.hotkey.bind({'alt'}, 't', function() openApp("终端") end)
hs.hotkey.bind({'alt'}, 'j', function() openApp("IntelliJ IDEA CE") end)
--hs.hotkey.bind({'alt'}, 'v', function() openApp("Visual Studio Code") end)i
-- 绑定快捷键：Alt + V
-- VSCode 窗口循环切换逻辑
-- 快捷键绑定 (⌥ + ⌘ + V)
local function focusNextVSCode()
    local vscodeAppNames = { "Visual Studio Code", "Code", "Code - Insiders" }
    local vscodeApp = nil
    local vscodeAppName = nil

    -- 找到正在运行的 VSCode 应用
    for _, name in ipairs(vscodeAppNames) do
        vscodeApp = hs.application.get(name)
        if vscodeApp then
            vscodeAppName = name
            break
        end
    end

    -- 1️⃣ VSCode 未启动 → 启动
    if not vscodeApp then
        hs.alert.show("Launching VSCode…")
        hs.task.new("/usr/bin/open", nil, { "-a", "Visual Studio Code" }):start()
        return
    end

    -- 2️⃣ 获取所有 VSCode 窗口
    local allWindows = vscodeApp:allWindows()
    local vscodeWindows = {}
    for _, win in ipairs(allWindows) do
        local ok, frame = pcall(function() return win:frame() end)
        if ok and frame and frame.w > 0 and frame.h > 0 then
            table.insert(vscodeWindows, win)
        end
    end

    -- 没有窗口 → 激活 VSCode
    if #vscodeWindows == 0 then
        hs.alert.show("Activating VSCode…")
        hs.osascript.applescript(string.format('tell application "%s" to activate', vscodeAppName))
        return
    end

    -- 按 ID 排序保证顺序一致
    table.sort(vscodeWindows, function(a, b)
        return a:id() < b:id()
    end)

    -- 当前窗口
    local currentWindow = hs.window.focusedWindow()
    local currentAppName = currentWindow and currentWindow:application():name() or ""

    -- 3️⃣ 当前不是 VSCode → 聚焦最后一个 VSCode 窗口
    if currentAppName ~= vscodeAppName then
        local target = vscodeWindows[#vscodeWindows]
        if target:isMinimized() then target:unminimize() end
        target:focus()
        vscodeApp:activate()

        -- 移动鼠标到窗口中心
        local f = target:frame()
        hs.mouse.setAbsolutePosition({ x = f.x + f.w / 2, y = f.y + f.h / 2 })
        return
    end

    -- 4️⃣ 当前是 VSCode
    if #vscodeWindows == 1 then
        vscodeWindows[1]:focus()
        vscodeApp:activate()
        local f = vscodeWindows[1]:frame()
        hs.mouse.setAbsolutePosition({ x = f.x + f.w / 2, y = f.y + f.h / 2 })
        return
    end

    -- 当前是 VSCode，有多个窗口 → 循环切换
    local currentId = currentWindow:id()
    local nextIndex = 1
    for i, win in ipairs(vscodeWindows) do
        if win:id() == currentId then
            nextIndex = (i % #vscodeWindows) + 1
            break
        end
    end

    local nextWin = vscodeWindows[nextIndex]
    if nextWin:isMinimized() then nextWin:unminimize() end
    nextWin:focus()
    vscodeApp:activate()

    -- 将鼠标移动到目标窗口中心（跨显示器）
    local f = nextWin:frame()
    hs.mouse.setAbsolutePosition({ x = f.x + f.w / 2, y = f.y + f.h / 2 })
end
-- 快捷键绑定 (⌥ + v)
hs.hotkey.bind({"alt"}, "v", focusNextVSCode)
    
   ```
